<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏</title>
    <meta name="description" content="–°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî —Å–æ–±—Ä–∞–Ω–∏–µ —Å–∞–º—ã—Ö –∂—É—Ç–∫–∏—Ö —Ä–∞—Å—Å–∫–∞–∑–æ–≤ —Å –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Ç—Ä–∞—à–∏–ª–∫–∏, –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏, –ø—É–≥–∞—é—â–∏–µ –ª–µ–≥–µ–Ω–¥—ã.">
    <meta name="keywords" content="—Å—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏, —Å—Ç—Ä–∞—à–∏–ª–∫–∏, —É–∂–∞—Å—ã, –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å–∫–∞–∑—ã, —Ö–æ—Ä—Ä–æ—Ä, –ø—É–≥–∞—é—â–∏–µ –∏—Å—Ç–æ—Ä–∏–∏, –ª–µ–≥–µ–Ω–¥—ã, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏">
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <header class="fixed-header">
        <div class="nav-left">
            <span class="nav-title">üëª –°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏</span>
            <a href="about.html">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
        </div>
        <div class="nav-right">
            <select id="category-select">
                <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            </select>
            <button id="sort-alpha" class="sort-btn">–ê-–Ø</button>
            <button id="sort-date" class="sort-btn">–ü–æ –¥–∞—Ç–µ</button>
            <button id="sort-popular" class="sort-btn">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</button>
            <button id="sort-default" class="sort-btn active">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
        </div>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
    <main>
        <h1>–°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏</h1>
        <p class="subtitle">–°–æ–±—Ä–∞–Ω–∏–µ —Å–∞–º—ã—Ö –∂—É—Ç–∫–∏—Ö —Ä–∞—Å—Å–∫–∞–∑–æ–≤ —Å –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</p>
        
        <div class="stories-container">
            <ul id="stories-list">
                <!-- –ò—Å—Ç–æ—Ä–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </ul>
        </div>

        <div class="share-section">
            <button id="share-btn" class="share-button">
                <span>üì§</span> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
            </button>
            <span id="share-status" class="share-status">–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!</span>
        </div>
    </main>

    <!-- –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ -->
    <button id="audio-toggle" class="control-btn audio-btn" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É">üîä</button>
    <button id="theme-toggle" class="control-btn theme-btn" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">üåô</button>

    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <audio id="bg-music" src="background.mp3" loop preload="auto"></audio>
    <audio id="hover-sfx" src="sfx-hover.mp3" preload="auto"></audio>

    <footer>
        ¬© 2025 –°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.<br>
        <a href="about.html">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
    </footer>

    <script src="stories.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            initializeTheme();
            initializeAudio();
            initializeFilters();
            initializeShare();
            renderStories();
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–æ–π
        function initializeTheme() {
            const themeToggle = document.getElementById('theme-toggle');
            let theme = localStorage.getItem('theme') || 'dark';
            
            function setTheme(mode) {
                document.body.classList.toggle('light-mode', mode === 'light');
                themeToggle.textContent = mode === 'light' ? '‚òÄÔ∏è' : 'üåô';
                themeToggle.title = mode === 'light' ? '–¢–µ–º–Ω–∞—è —Ç–µ–º–∞' : '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
            }
            
            setTheme(theme);
            
            themeToggle.addEventListener('click', () => {
                theme = theme === 'dark' ? 'light' : 'dark';
                localStorage.setItem('theme', theme);
                setTheme(theme);
            });
        }

                 // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ
         function initializeAudio() {
             const audioToggle = document.getElementById('audio-toggle');
             const bgMusic = document.getElementById('bg-music');
             const hoverSfx = document.getElementById('hover-sfx');
             let musicPlaying = false;
             let audioEnabled = localStorage.getItem('audioEnabled') !== 'false';
 
             // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
             bgMusic.volume = 0.3;
             hoverSfx.volume = 0.2;
 
             function updateAudioButton() {
                 audioToggle.textContent = musicPlaying ? 'üîä' : 'üîà';
                 audioToggle.title = musicPlaying ? '–í—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É' : '–í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É';
             }
 
             audioToggle.addEventListener('click', async () => {
                 try {
                     if (musicPlaying) {
                         bgMusic.pause();
                         musicPlaying = false;
                         audioEnabled = false;
                     } else {
                         await bgMusic.play();
                         musicPlaying = true;
                         audioEnabled = true;
                     }
                     localStorage.setItem('audioEnabled', audioEnabled);
                     updateAudioButton();
                 } catch (error) {
                     console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞—É–¥–∏–æ:', error);
                 }
             });
 
             // –ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
             if (audioEnabled) {
                 // –ü–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                 setTimeout(() => {
                     bgMusic.play().then(() => {
                         musicPlaying = true;
                         updateAudioButton();
                     }).catch(() => {
                         // –ï—Å–ª–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –Ω–µ —É–¥–∞–ª—Å—è, –ø—Ä–æ–±—É–µ–º –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞
                         document.addEventListener('click', () => {
                             if (audioEnabled && !musicPlaying) {
                                 bgMusic.play().then(() => {
                                     musicPlaying = true;
                                     updateAudioButton();
                                 }).catch(() => {});
                             }
                         }, { once: true });
                     });
                 }, 1000);
             }
 
             updateAudioButton();
 
             // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞ –Ω–∞–≤–µ–¥–µ–Ω–∏—è
             window.playHoverSound = function() {
                 if (audioEnabled) {
                     hoverSfx.currentTime = 0;
                     hoverSfx.play().catch(() => {});
                 }
             };
         }

        // –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
        function initializeFilters() {
            const categorySelect = document.getElementById('category-select');
            const sortButtons = document.querySelectorAll('.sort-btn');
            
            let currentCategory = 'all';
            let currentSort = 'default';

            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            const categories = [...new Set(stories.map(s => s.category))];
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categorySelect.appendChild(option);
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–º–µ–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            categorySelect.addEventListener('change', (e) => {
                currentCategory = e.target.value;
                renderStories();
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
            sortButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    sortButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentSort = btn.id.replace('sort-', '');
                    renderStories();
                });
            });

            // –§—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∏—Å—Ç–æ—Ä–∏–π
            window.renderStories = function() {
                const storiesList = document.getElementById('stories-list');
                let filtered = [...stories];

                // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                if (currentCategory !== 'all') {
                    filtered = filtered.filter(s => s.category === currentCategory);
                }

                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
                switch (currentSort) {
                    case 'alpha':
                        filtered.sort((a, b) => a.title.localeCompare(b.title, 'ru'));
                        break;
                    case 'date':
                        filtered.sort((a, b) => (b.date || 0) - (a.date || 0));
                        break;
                    case 'popular':
                        filtered.sort((a, b) => (b.views || 0) - (a.views || 0));
                        break;
                    default:
                        // –ü–æ—Ä—è–¥–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∫–∞–∫ –≤ –º–∞—Å—Å–∏–≤–µ)
                        break;
                }

                // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥
                storiesList.innerHTML = '';
                filtered.forEach(story => {
                    const li = document.createElement('li');
                    li.className = 'story-item';
                    
                    const link = document.createElement('a');
                    link.href = `story.html?id=${story.id}`;
                    link.className = 'story-link';
                    
                    link.innerHTML = `
                        <div class="story-title">${story.title}</div>
                        <div class="story-description">${story.description || '–ó–∞–≥–∞–¥–æ—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –±–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è...'}</div>
                        <div class="story-meta">
                            <span class="story-category">${story.category}</span>
                            <span class="story-views">${story.views || 0} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                        </div>
                    `;
                    
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–≤–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
                    link.addEventListener('mouseenter', window.playHoverSound);
                    
                    li.appendChild(link);
                    storiesList.appendChild(li);
                });
            };
        }

        // –§—É–Ω–∫—Ü–∏—è "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
        function initializeShare() {
            const shareBtn = document.getElementById('share-btn');
            const shareStatus = document.getElementById('share-status');

            shareBtn.addEventListener('click', async () => {
                const shareData = {
                    title: document.title,
                    text: '–ß–∏—Ç–∞–π —Å—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏!',
                    url: window.location.href
                };

                try {
                    if (navigator.share) {
                        await navigator.share(shareData);
                    } else {
                        await navigator.clipboard.writeText(window.location.href);
                        shareStatus.style.display = 'inline';
                        setTimeout(() => shareStatus.style.display = 'none', 2000);
                    }
                } catch (error) {
                    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                    const textArea = document.createElement('textarea');
                    textArea.value = window.location.href;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    shareStatus.style.display = 'inline';
                    setTimeout(() => shareStatus.style.display = 'none', 2000);
                }
            });
        }
    </script>
</body>
</html> 