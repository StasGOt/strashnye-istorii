<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏</title>
    <meta name="description" content="–°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî —Å–æ–±—Ä–∞–Ω–∏–µ —Å–∞–º—ã—Ö –∂—É—Ç–∫–∏—Ö —Ä–∞—Å—Å–∫–∞–∑–æ–≤ —Å –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Ç—Ä–∞—à–∏–ª–∫–∏, –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏, –ø—É–≥–∞—é—â–∏–µ –ª–µ–≥–µ–Ω–¥—ã.">
    <meta name="keywords" content="—Å—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏, —Å—Ç—Ä–∞—à–∏–ª–∫–∏, —É–∂–∞—Å—ã, –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å–∫–∞–∑—ã, —Ö–æ—Ä—Ä–æ—Ä, –ø—É–≥–∞—é—â–∏–µ –∏—Å—Ç–æ—Ä–∏–∏, –ª–µ–≥–µ–Ω–¥—ã, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏">
    <link rel="icon" type="image/png" href="./favicon.png" />
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <!-- –ü—Ä–µ–ª–æ–∞–¥–µ—Ä -->
    <div id="preloader" class="preloader">
        <div class="preloader-content">
            <div class="preloader-spinner"></div>
            <p>–ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏...</p>
        </div>
    </div>

    <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <header class="fixed-header">
        <div class="nav-left">
            <span class="nav-title">üëª –°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏</span>
            <a href="about.html">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
        </div>
        <div class="nav-center">
            <div class="search-container">
                <input type="text" id="search-input" placeholder="üîç –ü–æ–∏—Å–∫ –∏—Å—Ç–æ—Ä–∏–π..." class="search-input">
                <button id="search-clear" class="search-clear" title="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫">‚úï</button>
            </div>
        </div>
        <div class="nav-right">
            <select id="category-select">
                <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            </select>
            <button id="sort-alpha" class="sort-btn">–ê-–Ø</button>
            <button id="sort-date" class="sort-btn">–ü–æ –¥–∞—Ç–µ</button>
            <button id="sort-popular" class="sort-btn">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</button>
            <button id="sort-default" class="sort-btn active">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
        </div>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
    <main>
        <h1>–°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏</h1>
        <p class="subtitle">–°–æ–±—Ä–∞–Ω–∏–µ —Å–∞–º—ã—Ö –∂—É—Ç–∫–∏—Ö —Ä–∞—Å—Å–∫–∞–∑–æ–≤ —Å –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</p>
        
        <div class="stories-container">
            <ul id="stories-list">
                <!-- –°–∫–µ–ª–µ—Ç–æ–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ -->
                <li class="story-item skeleton skeleton-story">
                    <div class="skeleton-title"></div>
                    <div class="skeleton-meta"></div>
                </li>
                <li class="story-item skeleton skeleton-story">
                    <div class="skeleton-title"></div>
                    <div class="skeleton-meta"></div>
                </li>
                <li class="story-item skeleton skeleton-story">
                    <div class="skeleton-title"></div>
                    <div class="skeleton-meta"></div>
                </li>
                <li class="story-item skeleton skeleton-story">
                    <div class="skeleton-title"></div>
                    <div class="skeleton-meta"></div>
                </li>
                <li class="story-item skeleton skeleton-story">
                    <div class="skeleton-title"></div>
                    <div class="skeleton-meta"></div>
                </li>
                <li class="story-item skeleton skeleton-story">
                    <div class="skeleton-title"></div>
                    <div class="skeleton-meta"></div>
                </li>
            </ul>
        </div>

        <div class="share-section">
            <button id="share-btn" class="share-button">
                <span>üì§</span> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
            </button>
            <span id="share-status" class="share-status">–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!</span>
        </div>
    </main>

    <!-- –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ -->
    <button id="audio-toggle" class="control-btn audio-btn" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É">üîä</button>
    <button id="theme-toggle" class="control-btn theme-btn" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">üåô</button>

    <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <audio id="bg-music" src="background.mp3" loop preload="auto"></audio>
    <audio id="hover-sfx" src="sfx-hover.mp3" preload="auto"></audio>

    <footer>
        ¬© 2025 –°—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.<br>
        <a href="about.html">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
    </footer>

    <script src="stories.js"></script>
    <script src="audio.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–ª–æ–∞–¥–µ—Ä
            setTimeout(() => {
                const preloader = document.getElementById('preloader');
                preloader.classList.add('hidden');
                setTimeout(() => {
                    preloader.style.display = 'none';
                }, 500);
            }, 1000);

            initializeApp();
        });

        function initializeApp() {
            initializeTheme();
            initializeFilters();
            initializeSearch();
            initializeShare();
            renderStories();
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–æ–π
        function initializeTheme() {
            const themeToggle = document.getElementById('theme-toggle');
            let theme = localStorage.getItem('theme') || 'dark';
            
            function setTheme(mode) {
                document.body.classList.toggle('light-mode', mode === 'light');
                themeToggle.textContent = mode === 'light' ? '‚òÄÔ∏è' : 'üåô';
                themeToggle.title = mode === 'light' ? '–¢–µ–º–Ω–∞—è —Ç–µ–º–∞' : '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
            }
            
            setTheme(theme);
            
            themeToggle.addEventListener('click', () => {
                theme = theme === 'dark' ? 'light' : 'dark';
                localStorage.setItem('theme', theme);
                setTheme(theme);
            });
        }

                 

        // –ü–æ–∏—Å–∫
        function initializeSearch() {
            const searchInput = document.getElementById('search-input');
            const searchClear = document.getElementById('search-clear');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ –≤ –ø–æ–∏—Å–∫
            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase().trim();
                updateSearchClear(searchTerm);
                renderStories();
            });

            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–∏—Å–∫–∞
            searchClear.addEventListener('click', () => {
                searchInput.value = '';
                updateSearchClear('');
                renderStories();
                searchInput.focus();
            });

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –¥–ª—è –ø–æ–∏—Å–∫–∞
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    renderStories();
                }
            });

            function updateSearchClear(searchTerm) {
                searchClear.style.display = searchTerm ? 'block' : 'none';
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –∑–≤—É–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É –æ—á–∏—Å—Ç–∫–∏
            searchClear.addEventListener('click', window.playClickSound);
        }

        // –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
        function initializeFilters() {
            const categorySelect = document.getElementById('category-select');
            const sortButtons = document.querySelectorAll('.sort-btn');
            
            let currentCategory = 'all';
            let currentSort = 'default';

            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            const categories = [...new Set(stories.map(s => s.category))];
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categorySelect.appendChild(option);
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–º–µ–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            categorySelect.addEventListener('change', (e) => {
                currentCategory = e.target.value;
                renderStories();
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
            sortButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    sortButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentSort = btn.id.replace('sort-', '');
                    renderStories();
                });
            });

            // –§—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∏—Å—Ç–æ—Ä–∏–π
            window.renderStories = function() {
                const storiesList = document.getElementById('stories-list');
                const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
                let filtered = [...stories];

                // –ü–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –∏ —Ç–µ–∫—Å—Ç—É
                if (searchTerm) {
                    filtered = filtered.filter(story => 
                        story.title.toLowerCase().includes(searchTerm) ||
                        story.text.toLowerCase().includes(searchTerm)
                    );
                }

                // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                if (currentCategory !== 'all') {
                    filtered = filtered.filter(s => s.category === currentCategory);
                }

                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
                switch (currentSort) {
                    case 'alpha':
                        filtered.sort((a, b) => a.title.localeCompare(b.title, 'ru'));
                        break;
                    case 'date':
                        filtered.sort((a, b) => (b.date || 0) - (a.date || 0));
                        break;
                    case 'popular':
                        filtered.sort((a, b) => (b.views || 0) - (a.views || 0));
                        break;
                    default:
                        // –ü–æ—Ä—è–¥–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∫–∞–∫ –≤ –º–∞—Å—Å–∏–≤–µ)
                        break;
                }

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π
                updateSearchResults(filtered.length, searchTerm);

                // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥
                storiesList.innerHTML = '';
                if (filtered.length === 0) {
                    storiesList.innerHTML = `
                        <li class="no-results">
                            <div class="no-results-content">
                                <h3>üîç –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</p>
                            </div>
                        </li>
                    `;
                } else {
                    filtered.forEach(story => {
                        const li = document.createElement('li');
                        li.className = 'story-item';
                        
                        const link = document.createElement('a');
                        link.href = `story.html?id=${story.id}`;
                        link.className = 'story-link';
                        
                        link.innerHTML = `
                            <div class="story-title">${story.title}</div>
                            <div class="story-meta">
                                <span class="story-category">${story.category}</span>
                                <span class="story-views">${story.views || 0} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                            </div>
                        `;
                        
                        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–≤–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ
                        link.addEventListener('click', window.playClickSound);
                        
                        li.appendChild(link);
                        storiesList.appendChild(li);
                    });
                }
            };
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
        function updateSearchResults(count, searchTerm) {
            const subtitle = document.querySelector('.subtitle');
            if (searchTerm) {
                subtitle.textContent = `–ù–∞–π–¥–µ–Ω–æ ${count} –∏—Å—Ç–æ—Ä–∏–π –ø–æ –∑–∞–ø—Ä–æ—Å—É "${searchTerm}"`;
            } else {
                subtitle.textContent = '–°–æ–±—Ä–∞–Ω–∏–µ —Å–∞–º—ã—Ö –∂—É—Ç–∫–∏—Ö —Ä–∞—Å—Å–∫–∞–∑–æ–≤ —Å –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
        function initializeShare() {
            const shareBtn = document.getElementById('share-btn');
            const shareStatus = document.getElementById('share-status');

            shareBtn.addEventListener('click', async () => {
                const shareData = {
                    title: document.title,
                    text: '–ß–∏—Ç–∞–π —Å—Ç—Ä–∞—à–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏!',
                    url: window.location.href
                };

                try {
                    if (navigator.share) {
                        await navigator.share(shareData);
                    } else {
                        await navigator.clipboard.writeText(window.location.href);
                        shareStatus.style.display = 'inline';
                        setTimeout(() => shareStatus.style.display = 'none', 2000);
                    }
                } catch (error) {
                    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                    const textArea = document.createElement('textarea');
                    textArea.value = window.location.href;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    shareStatus.style.display = 'inline';
                    setTimeout(() => shareStatus.style.display = 'none', 2000);
                }
            });
        }
    </script>
</body>
</html> 